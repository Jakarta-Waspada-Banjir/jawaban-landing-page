import L from "leaflet";
import React from "react";
import { Marker, Popup } from "react-leaflet";

import { Card, CardContent, CardHeader } from "@/components/ui";
import { initialReservoir } from "@/data/FloodInformationMap";
import { removeWord } from "@/utils";

const markerReservoir = L.divIcon({
  html: `<svg width="25" height="37" viewBox="0 0 34 46" fill="none" xmlns="http://www.w3.org/2000/svg">
<g clipPath="url(#clip0_2008_1144)">
<circle cx="17.5" cy="15.5" r="9.5" fill="#4B84A3" />
<path d="M17 0.5C12.6239 0.5 8.42709 2.23839 5.33274 5.33274C2.23839 8.42709 0.5 12.6239 0.5 17C0.5 25.715 15.2 44.15 15.83 44.945C15.9706 45.1202 16.1487 45.2616 16.3512 45.3587C16.5537 45.4559 16.7754 45.5063 17 45.5063C17.2246 45.5063 17.4463 45.4559 17.6488 45.3587C17.8513 45.2616 18.0294 45.1202 18.17 44.945C18.8 44.15 33.5 25.715 33.5 17C33.5 12.6239 31.7616 8.42709 28.6673 5.33274C25.5729 2.23839 21.3761 0.5 17 0.5ZM17 24.5C15.22 24.5 13.4799 23.9722 11.9999 22.9832C10.5198 21.9943 9.36627 20.5887 8.68509 18.9442C8.0039 17.2996 7.82567 15.49 8.17293 13.7442C8.5202 11.9984 9.37737 10.3947 10.636 9.13604C11.8947 7.87737 13.4984 7.0202 15.2442 6.67293C16.99 6.32567 18.7996 6.5039 20.4442 7.18508C22.0887 7.86627 23.4943 9.01983 24.4832 10.4999C25.4722 11.9799 26 13.72 26 15.5C26 17.8869 25.0518 20.1761 23.364 21.864C21.6761 23.5518 19.3869 24.5 17 24.5Z" fill="#4B84A3" />
<path d="M17 0.5V6.5V11C17 11 17 12.6131 17 15C17 17.3869 17.0002 18.5 17.0002 21C16.9998 23 17 23 17 24.5V45.5C17.2253 45.499 17.4475 45.4472 17.65 45.3485C17.8526 45.2498 18.0303 45.1068 18.17 44.93C18.8 44.15 33.5 25.715 33.5 17C33.5 12.6239 31.7616 8.42709 28.6673 5.33274C25.5729 2.23839 21.3761 0.5 17 0.5Z" fill="#3A6C87" />
<path d="M27.9215 24.5271V25.9933H12.4684L12.2959 24.0527C12.7128 24.2468 12.9823 24.5271 13.7514 24.5271C14.9301 24.5271 14.9301 23.8658 16.1125 23.8658C17.2948 23.8658 17.2912 24.5271 18.4736 24.5271C19.6559 24.5271 19.6523 23.8658 20.8311 23.8658C22.0098 23.8658 22.0134 24.5271 23.1957 24.5271C24.3781 24.5271 24.3745 23.8658 25.5568 23.8658C26.7392 23.8658 26.7392 24.5271 27.9215 24.5271Z" fill="white" />
<path d="M27.9218 22.7302V24.5271C26.7395 24.5271 26.7395 23.8658 25.5571 23.8658C24.3748 23.8658 24.3748 24.5271 23.196 24.5271C22.0173 24.5271 22.0137 23.8658 20.8313 23.8658C19.649 23.8658 19.6526 24.5271 18.4738 24.5271C17.2951 24.5271 17.2915 23.8658 16.1127 23.8658C14.934 23.8658 14.9304 24.5271 13.7516 24.5271C12.9826 24.5271 12.713 24.2468 12.2962 24.0527L12.1309 22.1876C12.6555 22.378 12.8891 22.7302 13.7516 22.7302C14.9304 22.7302 14.9304 22.069 16.1127 22.069C17.2951 22.069 17.2915 22.7302 18.4738 22.7302C19.6562 22.7302 19.6526 22.069 20.8313 22.069C22.0101 22.069 22.0137 22.7302 23.196 22.7302C24.3784 22.7302 24.3748 22.069 25.5571 22.069C26.7395 22.069 26.7395 22.7302 27.9218 22.7302Z" fill="white" />
<path d="M27.9221 20.9333V22.7302C26.7397 22.7302 26.7397 22.069 25.5574 22.069C24.375 22.069 24.375 22.7302 23.1963 22.7302C22.0175 22.7302 22.0139 22.069 20.8316 22.069C19.6493 22.069 19.6529 22.7302 18.4741 22.7302C17.2954 22.7302 17.2918 22.069 16.113 22.069C14.9343 22.069 14.9307 22.7302 13.7519 22.7302C12.8894 22.7302 12.6558 22.378 12.1311 22.1876L11.9658 20.3404C12.6163 20.5057 12.8032 20.9333 13.7519 20.9333C14.9307 20.9333 14.9307 20.2721 16.113 20.2721C17.2954 20.2721 17.2918 20.9333 18.4741 20.9333C19.6564 20.9333 19.6529 20.2721 20.8316 20.2721C22.0104 20.2721 22.0139 20.9333 23.1963 20.9333C24.3786 20.9333 24.375 20.2721 25.5574 20.2721C26.7397 20.2721 26.7397 20.9333 27.9221 20.9333Z" fill="white" />
<path d="M27.9217 19.1365V20.9333C26.7393 20.9333 26.7393 20.2721 25.557 20.2721C24.3746 20.2721 24.3746 20.9333 23.1959 20.9333C22.0171 20.9333 22.0136 20.2721 20.8312 20.2721C19.6489 20.2721 19.6525 20.9333 18.4737 20.9333C17.295 20.9333 17.2914 20.2721 16.1126 20.2721C14.9339 20.2721 14.9303 20.9333 13.7515 20.9333C12.8028 20.9333 12.6159 20.5057 11.9654 20.3404L11.8037 18.5076C12.5907 18.6405 12.7273 19.1365 13.7515 19.1365C14.9303 19.1365 14.9303 18.4752 16.1126 18.4752C17.295 18.4752 17.2914 19.1365 18.4737 19.1365C19.6561 19.1365 19.6525 18.4752 20.8312 18.4752C22.01 18.4752 22.0136 19.1365 23.1959 19.1365C24.3782 19.1365 24.3746 18.4752 25.557 18.4752C26.7393 18.4752 26.7393 19.1365 27.9217 19.1365Z" fill="white" />
<path d="M27.922 16.6495V19.1364C26.7396 19.1364 26.7396 18.4752 25.5573 18.4752C24.3749 18.4752 24.3749 19.1364 23.1962 19.1364C22.0174 19.1364 22.0138 18.4752 20.8315 18.4752C19.6491 18.4752 19.6527 19.1364 18.474 19.1364C17.2952 19.1364 17.2916 18.4752 16.1129 18.4752C14.9341 18.4752 14.9305 19.1364 13.7518 19.1364C12.7276 19.1364 12.591 18.6405 11.804 18.5075L11.6387 16.6495H27.922Z" fill="white" />
<path d="M27.9222 13.7745V16.6495H11.6389L11.3838 13.7745H27.9222Z" fill="white" />
<path d="M12.4688 25.9933H7.07812L8.15625 9.82141H11.0312L12.4688 25.9933Z" fill="white" />
<path d="M27.9218 13.4152H24.6515L26.5346 13.4192H26.662H24.9825H22.1718L19.3611 13.4193L17.6815 13.4192L17.809 13.4193L19.6921 13.4152H11.7104L11.3905 9.78907C11.3817 9.69975 11.3401 9.61686 11.2737 9.55646C11.2073 9.49605 11.1209 9.4624 11.0312 9.46204H8.15617C8.06506 9.46181 7.97726 9.4962 7.91055 9.55825C7.84383 9.6203 7.80317 9.70537 7.79679 9.79626L6.71867 25.9681C6.71517 26.0173 6.72199 26.0667 6.7387 26.1132C6.75541 26.1596 6.78164 26.202 6.8157 26.2377C6.84879 26.2743 6.88928 26.3035 6.93451 26.3234C6.97974 26.3432 7.02866 26.3532 7.07804 26.3527H27.9218C28.0171 26.3527 28.1085 26.3148 28.1759 26.2474C28.2433 26.18 28.2812 26.0886 28.2812 25.9933V13.7745C28.2812 13.6792 28.2433 13.5878 28.1759 13.5204C28.1085 13.453 28.0171 13.4152 27.9218 13.4152ZM7.46257 25.6339L8.49398 10.1808H10.7005L12.0769 25.6339H7.46257ZM27.5624 25.6339H12.7993L12.713 24.6744C13.0383 24.824 13.3937 24.8965 13.7516 24.8864C14.2304 24.8959 14.7015 24.7647 15.1065 24.5091C15.4058 24.3155 15.7564 24.2166 16.1127 24.2252C16.4681 24.2152 16.818 24.3143 17.1154 24.5091C17.5248 24.7559 17.9939 24.8864 18.472 24.8864C18.9501 24.8864 19.4192 24.7559 19.8287 24.5091C20.1261 24.3143 20.476 24.2152 20.8313 24.2252C21.1876 24.2171 21.5381 24.316 21.8376 24.5091C22.247 24.7559 22.7161 24.8864 23.1942 24.8864C23.6723 24.8864 24.1414 24.7559 24.5509 24.5091C24.8537 24.3234 25.2019 24.2252 25.5571 24.2252C25.9123 24.2252 26.2605 24.3234 26.5634 24.5091C26.867 24.6979 27.2077 24.8192 27.5624 24.8649V25.6339ZM27.5624 24.1389C27.3332 24.0933 27.1141 24.0069 26.9155 23.8838C26.5054 23.6369 26.0358 23.5064 25.5571 23.5064C25.0784 23.5064 24.6088 23.6369 24.1987 23.8838C23.9013 24.0785 23.5514 24.1776 23.196 24.1677C22.8398 24.1757 22.4893 24.0768 22.1898 23.8838C21.7803 23.6369 21.3112 23.5064 20.8331 23.5064C20.355 23.5064 19.8859 23.6369 19.4765 23.8838C19.1791 24.0785 18.8292 24.1776 18.4738 24.1677C18.1175 24.1762 17.7669 24.0773 17.4676 23.8838C17.0581 23.6369 16.5891 23.5064 16.1109 23.5064C15.6328 23.5064 15.1637 23.6369 14.7543 23.8838C14.4569 24.0785 14.107 24.1776 13.7516 24.1677C13.3954 24.1757 13.0449 24.0768 12.7454 23.8838C12.7094 23.8622 12.6735 23.8442 12.6376 23.8263L12.5441 22.7949C12.9132 22.9989 13.3301 23.1006 13.7516 23.0895C14.2304 23.099 14.7015 22.9678 15.1065 22.7122C15.4058 22.5186 15.7564 22.4197 16.1127 22.4283C16.4681 22.4184 16.818 22.5174 17.1154 22.7122C17.5248 22.9591 17.9939 23.0895 18.472 23.0895C18.9501 23.0895 19.4192 22.9591 19.8287 22.7122C20.1261 22.5174 20.476 22.4184 20.8313 22.4283C21.1876 22.4203 21.5381 22.5191 21.8376 22.7122C22.247 22.9591 22.7161 23.0895 23.1942 23.0895C23.6723 23.0895 24.1414 22.9591 24.5509 22.7122C24.8537 22.5265 25.2019 22.4283 25.5571 22.4283C25.9123 22.4283 26.2605 22.5265 26.5634 22.7122C26.867 22.901 27.2077 23.0223 27.5624 23.068V24.1389ZM27.5624 22.342C27.3332 22.2965 27.1141 22.21 26.9155 22.0869C26.5054 21.84 26.0358 21.7095 25.5571 21.7095C25.0784 21.7095 24.6088 21.84 24.1987 22.0869C23.9013 22.2816 23.5514 22.3807 23.196 22.3708C22.8398 22.3788 22.4893 22.2799 22.1898 22.0869C21.7803 21.84 21.3112 21.7095 20.8331 21.7095C20.355 21.7095 19.8859 21.84 19.4765 22.0869C19.1791 22.2816 18.8292 22.3807 18.4738 22.3708C18.1175 22.3794 17.7669 22.2804 17.4676 22.0869C17.0581 21.84 16.5891 21.7095 16.1109 21.7095C15.6328 21.7095 15.1637 21.84 14.7543 22.0869C14.4569 22.2816 14.107 22.3807 13.7516 22.3708C13.3952 22.3806 13.0442 22.2816 12.7454 22.0869C12.6591 22.0366 12.5657 21.9899 12.4687 21.9431L12.3788 20.9081C12.3843 20.9125 12.3903 20.9161 12.3968 20.9189C12.8022 21.1731 13.2732 21.303 13.7516 21.2927C14.2304 21.3021 14.7015 21.1709 15.1065 20.9153C15.4058 20.7218 15.7564 20.6228 16.1127 20.6314C16.4681 20.6215 16.818 20.7206 17.1154 20.9153C17.5248 21.1622 17.9939 21.2927 18.472 21.2927C18.9501 21.2927 19.4192 21.1622 19.8287 20.9153C20.1261 20.7206 20.476 20.6215 20.8313 20.6314C21.1876 20.6234 21.5381 20.7223 21.8376 20.9153C22.247 21.1622 22.7161 21.2927 23.1942 21.2927C23.6723 21.2927 24.1414 21.1622 24.5509 20.9153C24.8537 20.7297 25.2019 20.6314 25.5571 20.6314C25.9123 20.6314 26.2605 20.7297 26.5634 20.9153C26.867 21.1041 27.2077 21.2255 27.5624 21.2711V22.342ZM27.5624 20.5452C27.3332 20.4996 27.1141 20.4132 26.9155 20.29C26.5054 20.0431 26.0358 19.9127 25.5571 19.9127C25.0784 19.9127 24.6088 20.0431 24.1987 20.29C23.9013 20.4848 23.5514 20.5838 23.196 20.5739C22.8398 20.5819 22.4893 20.4831 22.1898 20.29C21.7803 20.0431 21.3112 19.9127 20.8331 19.9127C20.355 19.9127 19.8859 20.0431 19.4765 20.29C19.1791 20.4848 18.8292 20.5838 18.4738 20.5739C18.1175 20.5825 17.7669 20.4836 17.4676 20.29C17.0581 20.0431 16.5891 19.9127 16.1109 19.9127C15.6328 19.9127 15.1637 20.0431 14.7543 20.29C14.4569 20.4848 14.107 20.5838 13.7516 20.5739C13.3965 20.582 13.0471 20.4831 12.749 20.29C12.6062 20.2068 12.4572 20.1348 12.3034 20.0744L12.2099 19.0214C12.271 19.0502 12.3321 19.0861 12.3932 19.1184C12.7993 19.3745 13.2716 19.5057 13.7516 19.4958C14.2304 19.5053 14.7015 19.3741 15.1065 19.1184C15.4058 18.9249 15.7564 18.826 16.1127 18.8345C16.4681 18.8246 16.818 18.9237 17.1154 19.1184C17.5248 19.3653 17.9939 19.4958 18.472 19.4958C18.9501 19.4958 19.4192 19.3653 19.8287 19.1184C20.1261 18.9237 20.476 18.8246 20.8313 18.8345C21.1876 18.8265 21.5381 18.9254 21.8376 19.1184C22.247 19.3653 22.7161 19.4958 23.1942 19.4958C23.6723 19.4958 24.1414 19.3653 24.5509 19.1184C24.8537 18.9328 25.2019 18.8345 25.5571 18.8345C25.9123 18.8345 26.2605 18.9328 26.5634 19.1184C26.867 19.3073 27.2077 19.4286 27.5624 19.4742V20.5452ZM27.5624 18.7483C27.3332 18.7027 27.1141 18.6163 26.9155 18.4931C26.5054 18.2462 26.0358 18.1158 25.5571 18.1158C25.0784 18.1158 24.6088 18.2462 24.1987 18.4931C23.9013 18.6879 23.5514 18.787 23.196 18.777C22.8398 18.7851 22.4893 18.6862 22.1898 18.4931C21.7803 18.2463 21.3112 18.1158 20.8331 18.1158C20.355 18.1158 19.8859 18.2463 19.4765 18.4931C19.1791 18.6879 18.8292 18.787 18.4738 18.777C18.1175 18.7856 17.7669 18.6867 17.4676 18.4931C17.0581 18.2463 16.5891 18.1158 16.1109 18.1158C15.6328 18.1158 15.1637 18.2463 14.7543 18.4931C14.4569 18.6879 14.107 18.787 13.7516 18.777C13.3952 18.7869 13.0442 18.6878 12.7454 18.4931C12.5542 18.3779 12.3504 18.2851 12.138 18.2164L12.0302 17.0089H27.5624V18.7483ZM27.5624 16.2902H11.9655L11.7751 14.1339H27.5624V16.2902Z" fill="#4B84A3" />
</g>
<defs>
<clipPath id="clip0_2008_1144">
<rect width="25" height="37" fill="white" />
</clipPath>
</defs>
</svg>`,
  iconSize: [25, 32],
  className: "marker-icon",
});

export const ReservoirMarker = ({ activeReservoirMarker }) => {
  return (
    <>
      {initialReservoir.map((reservoir) =>
        activeReservoirMarker ? (
          <Marker
            key={reservoir.properties.id}
            position={[
              Number(reservoir.geometry.coordinates[1]),
              Number(reservoir.geometry.coordinates[0]),
            ]}
            icon={markerReservoir}
          >
            <Popup className="m-0">
              <Card>
                <CardHeader className="rounded-t-lg bg-[#4B84A3] p-0">
                  <h3 className="p-2 text-center text-sm font-semibold text-white">
                    Waduk {removeWord(reservoir.properties.nama_waduk, "Waduk")}
                  </h3>
                </CardHeader>
                <CardContent className="p-2">
                  <h4 className="mb-1.5 text-sm font-bold text-gray-700">
                    Luas Rencana{" "}
                    <span className="text-sm font-semibold text-gray-400">
                      {reservoir.properties.luas_rencana !== null &&
                      reservoir.properties.luas_rencana !== undefined
                        ? reservoir.properties.luas_rencana + " Hektar"
                        : "-"}
                    </span>
                  </h4>
                  <h4 className="mb-1.5 text-sm font-bold text-gray-700">
                    Luas Realisasi{" "}
                    <span className="text-sm font-semibold text-gray-400">
                      {reservoir.properties.luas !== null &&
                      reservoir.properties.luas !== undefined
                        ? reservoir.properties.luas + " Hektar"
                        : "-"}
                    </span>
                  </h4>
                  <h4 className="mb-1.5 text-sm font-bold text-gray-700">
                    Luas Badan Air{" "}
                    <span className="text-sm font-semibold text-gray-400">
                      {reservoir.properties.luas_badan_air !== null &&
                      reservoir.properties.luas_badan_air !== undefined
                        ? reservoir.properties.luas_badan_air + " Hektar"
                        : "-"}
                    </span>
                  </h4>
                  <h4 className="mb-1.5 text-sm font-bold text-gray-700">
                    Volume{" "}
                    <span className="text-sm font-semibold text-gray-400">
                      {reservoir.properties.volume !== null &&
                      reservoir.properties.volume !== undefined ? (
                        <>
                          {reservoir.properties.volume} m<sup>3</sup>
                        </>
                      ) : (
                        "-"
                      )}
                    </span>
                  </h4>
                  <h4 className="mb-1.5 text-sm font-bold text-gray-700">
                    Tersedia Pompa{" "}
                    <span className="text-sm font-semibold text-gray-400">
                      {reservoir.properties.pompa !== null &&
                      reservoir.properties.pompa !== undefined
                        ? reservoir.properties.pompa == 0
                          ? "Tidak"
                          : "Ya"
                        : "-"}
                    </span>
                  </h4>
                </CardContent>
              </Card>
            </Popup>
          </Marker>
        ) : null,
      )}
    </>
  );
};
